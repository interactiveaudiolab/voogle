TODO:
  - more tests
  - dataset timestamp stuff
